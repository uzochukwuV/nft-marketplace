{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/ASUS%20FX95G/Desktop/celusion/nft-marketplace/frontend/components/transactions.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport { IWeb3Context, useWeb3Context } from '@/context/web3Context';\r\nimport useContract, { market } from '@/hooks/useReadContract';\r\nimport { ethers } from 'ethers';\r\n\r\nimport React, { useEffect, useState } from 'react'\r\n\r\nfunction UserTransacions() {\r\n    const { state } = useWeb3Context() as IWeb3Context;\r\n    const market_contract = useContract({ contracts: \"BaseMarket\" });\r\n    const nft_contract = useContract({ contracts: \"BaseNft\" });\r\n    const [transactions , setTransactions] = useState<any>()\r\n    const [isLoading, setLoading] = useState<boolean>(false);\r\n\r\n    useEffect(() => {\r\n        getUserLogs()\r\n    }, [])\r\n    \r\n\r\n    async function getUserLogs() {\r\n        setLoading(true)\r\n        const filter = market_contract?.filters.AssetListed(null, null, null);\r\n        const block = await market_contract?.deploymentTransaction()?.getBlock()\r\n        const events = await market_contract?.queryFilter(filter!,block?.number,  \"latest\")\r\n\r\n        console.log(events)\r\n\r\n        let eventData = []\r\n\r\n        for (const event of events!){\r\n            const [tokenId,price, address] = (event as any)?.args as any;\r\n            console.log(address)\r\n            if(address.toLowerCase() == state.address){\r\n                eventData.push({price, address, tokenId, type:\"AssetListed\", contract:\"BaseMarket\"});\r\n            }\r\n        }\r\n        setTransactions(eventData)\r\n        console.log(eventData)\r\n        const filter2 = market_contract?.filters.AssetPurchased(null, null, null);\r\n        const events2 = await market_contract?.queryFilter(filter!,block?.number,  \"latest\")\r\n        \r\n        let eventData2 = []\r\n\r\n        for (const event of events2!){\r\n            const [tokenId,price, address, address2 ] = (event as any)?.args as any;\r\n            console.log(address)\r\n            if(address.toLowerCase() == state.address || address2.toLowerCase() == state.address){\r\n                eventData2.push({price, address, tokenId, type:\"AssetPurchased\", contract:\"BaseMarket\"});\r\n            }\r\n        }\r\n        console.log(eventData2)\r\n        setLoading(false)\r\n      }\r\n  return (\r\n    <div>\r\n        <section className='relative antialiased text-pretty px-12'>\r\n                <div className='space-y-4'>\r\n                    {  !isLoading &&\r\n                        transactions?.map((trx:any)=>{\r\n                            return <div className=' px-6 rounded-2xl py-4 bg-zinc-600 flex justify-between items-center'>\r\n                                <div>\r\n                                    {trx.contract} \r\n                                </div>\r\n                                <div>\r\n                                    {trx.type}\r\n                                </div>\r\n                                <div>\r\n                                    to :{trx.address}\r\n                                </div>\r\n                                <div>\r\n                                    data: {trx.price} {trx.tokenId}\r\n                                </div>\r\n                            </div>\r\n                        })\r\n                    }\r\n                </div>\r\n        </section>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default UserTransacions"],"names":[],"mappings":";;;;AAEA;AACA;AAGA;AANA;;;;;AAQA,SAAS;IACL,MAAM,EAAE,KAAK,EAAE,GAAG,CAAA,GAAA,uHAAA,CAAA,iBAAc,AAAD;IAC/B,MAAM,kBAAkB,CAAA,GAAA,yHAAA,CAAA,UAAW,AAAD,EAAE;QAAE,WAAW;IAAa;IAC9D,MAAM,eAAe,CAAA,GAAA,yHAAA,CAAA,UAAW,AAAD,EAAE;QAAE,WAAW;IAAU;IACxD,MAAM,CAAC,cAAe,gBAAgB,GAAG,CAAA,GAAA,oUAAA,CAAA,WAAQ,AAAD;IAChD,MAAM,CAAC,WAAW,WAAW,GAAG,CAAA,GAAA,oUAAA,CAAA,WAAQ,AAAD,EAAW;IAElD,CAAA,GAAA,oUAAA,CAAA,YAAS,AAAD,EAAE;QACN;IACJ,GAAG,EAAE;IAGL,eAAe;QACX,WAAW;QACX,MAAM,SAAS,iBAAiB,QAAQ,YAAY,MAAM,MAAM;QAChE,MAAM,QAAQ,MAAM,iBAAiB,yBAAyB;QAC9D,MAAM,SAAS,MAAM,iBAAiB,YAAY,QAAQ,OAAO,QAAS;QAE1E,QAAQ,GAAG,CAAC;QAEZ,IAAI,YAAY,EAAE;QAElB,KAAK,MAAM,SAAS,OAAQ;YACxB,MAAM,CAAC,SAAQ,OAAO,QAAQ,GAAI,OAAe;YACjD,QAAQ,GAAG,CAAC;YACZ,IAAG,QAAQ,WAAW,MAAM,MAAM,OAAO,EAAC;gBACtC,UAAU,IAAI,CAAC;oBAAC;oBAAO;oBAAS;oBAAS,MAAK;oBAAe,UAAS;gBAAY;YACtF;QACJ;QACA,gBAAgB;QAChB,QAAQ,GAAG,CAAC;QACZ,MAAM,UAAU,iBAAiB,QAAQ,eAAe,MAAM,MAAM;QACpE,MAAM,UAAU,MAAM,iBAAiB,YAAY,QAAQ,OAAO,QAAS;QAE3E,IAAI,aAAa,EAAE;QAEnB,KAAK,MAAM,SAAS,QAAS;YACzB,MAAM,CAAC,SAAQ,OAAO,SAAS,SAAU,GAAI,OAAe;YAC5D,QAAQ,GAAG,CAAC;YACZ,IAAG,QAAQ,WAAW,MAAM,MAAM,OAAO,IAAI,SAAS,WAAW,MAAM,MAAM,OAAO,EAAC;gBACjF,WAAW,IAAI,CAAC;oBAAC;oBAAO;oBAAS;oBAAS,MAAK;oBAAkB,UAAS;gBAAY;YAC1F;QACJ;QACA,QAAQ,GAAG,CAAC;QACZ,WAAW;IACb;IACJ,qBACE,6WAAC;kBACG,cAAA,6WAAC;YAAQ,WAAU;sBACX,cAAA,6WAAC;gBAAI,WAAU;0BACR,CAAC,aACA,cAAc,IAAI,CAAC;oBACf,qBAAO,6WAAC;wBAAI,WAAU;;0CAClB,6WAAC;0CACI,IAAI,QAAQ;;;;;;0CAEjB,6WAAC;0CACI,IAAI,IAAI;;;;;;0CAEb,6WAAC;;oCAAI;oCACI,IAAI,OAAO;;;;;;;0CAEpB,6WAAC;;oCAAI;oCACM,IAAI,KAAK;oCAAC;oCAAE,IAAI,OAAO;;;;;;;;;;;;;gBAG1C;;;;;;;;;;;;;;;;AAMxB;uCAEe","debugId":null}}]
}